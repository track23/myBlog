(()=>{const e="https://cdn.jsdelivr.net",n=document.getElementById("secondary-toggle"),t=document.getElementById("secondary"),o="undefined"!=typeof window,i=o&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent),a=o&&"IntersectionObserver"in window,c="UqKcJNE0cBerSu52yLvC1qVs-gzGzoHsz",s="cUR3tOdrBA0ULbONb8sfOipw";let l=null,r=null,d=null,g=document.getElementsByClassName("loading-bar")[0],u=document.querySelector(".loading-bar>.progress"),m=null;function p(e,n,t){const o=document.createElement("script");o.src=e,n&&(o.onload=n),t&&(o.type="module"),o.async=!0,document.body.appendChild(o)}function f(){i||(r=new Pjax({selectors:["title","#main"],cacheBust:!1}))}function h(){new Valine({el:"#valine",count_el:"#comment-count",lang:"zh-cn",emoticon_url:e+"/gh/track23/blog-static/alu",emoticon_list:["吐.png","喷血.png","狂汗.png","不说话.png","汗.png","坐等.png","献花.png","不高兴.png","中刀.png","害羞.png","皱眉.png","小眼睛.png","中指.png","尴尬.png","瞅你.png","想一想.png","中枪.png","得意.png","肿包.png","扇耳光.png","亲亲.png","惊喜.png","脸红.png","无所谓.png","便便.png","愤怒.png","蜡烛.png","献黄瓜.png","内伤.png","投降.png","观察.png","看不见.png","击掌.png","抠鼻.png","邪恶.png","看热闹.png","口水.png","抽烟.png","锁眉.png","装大款.png","吐舌.png","无奈.png","长草.png","赞一个.png","呲牙.png","无语.png","阴暗.png","不出所料.png","咽气.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png","黑线.png","喜极而泣.png","喷水.png","深思.png","鼓掌.png","暗地观察.png"],app_id:c,app_key:s,placeholder:"Write a Comment",admin_email_hash:"ed69c6079398441b73dbfdbbfc8cd196",max_nest:2,page_size:5})}function y(){const e=document.getElementById("comment");if(!i&&a&&e){let n=new IntersectionObserver((function(e){e[0].isIntersecting&&(h(),n.disconnect(),n=null)}),{threshold:[0]});n.observe(e)}else e&&h()}function v(){AV.initialize(c,s);var e=AV.Object.extend("Counter");1===document.getElementsByClassName("leancloud_visitors").length?function(e){e=AV.Object.extend("Counter"),document.querySelectorAll(".leancloud_visitors").forEach((function(e){url=e.getAttribute("id").trim(),title=e.getAttribute("data-flag-title").trim()}));var n=new AV.Query(e);n.equalTo("url",url),n.find({success:function(n){if(n.length>0){var t=n[0];t.fetchWhenSave(!0),t.increment("time"),t.save(null,{success:function(e){document.getElementById(url).innerText=e.get("time")},error:function(e,n){console.log("Failed to save Visitor num, with error message: "+n.message)}})}else{var o=new e;o.set("title",title),o.set("url",url),o.set("time",1),o.save(null,{success:function(e){console.log("newcounter.get('time')="+e.get("time")),document.getElementById(url).innerText,e.get("time"),document.getElementById(url).innerText=e.get("time")},error:function(e,n){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}(e):document.getElementsByClassName("post-title-link").length>1&&function(e){var n=new AV.Query(e);document.querySelectorAll(".leancloud_visitors").forEach((function(e){var t=e.getAttribute("id").trim();n.equalTo("url",t),n.find({success:function(e){if(0!==e.length)for(var n=0;n<e.length;n++){var o=e[n];document.getElementById(t).innerText=o.get("time")}else{var i=document.getElementById(t).innerText+": 0";document.getElementById(t).innerText=i}},error:function(e,n){console.log("Error: "+n.code+" "+n.message)}})}))}(e)}function E(){t.classList.toggle("toggle-on")?(n.classList.remove("iconcaidan"),n.classList.add("iconfork"),t.setAttribute("aria-expanded","true")):(n.classList.remove("iconfork"),n.classList.add("iconcaidan"),t.setAttribute("aria-expanded","false"))}function b(e){const n=function(e,n,t=0){return(e+(15-e)*Math.random()).toFixed(t)}(0);document.getElementById("friend-link").href=e[n].url,document.getElementById("friend-name").innerText=e[n].name,document.getElementById("friend-desc").innerText=e[n].description}function w(){Array.isArray(d)?b(d):fetch("/friend.json").then((function(e){return e.json()})).then((function(e){b(e),d=e}))}foo.search=function(){const e=function(e){const n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;",'""':"&#39;",'"/"':"&#x2F;"};if("string"!=typeof e)throw new TypeError("str must be a string!");return e.replace(/[&<>"'\/]/g,(function(e){return n[e]}))}(decodeURIComponent(window.location.search).substring(1).split("&")[0].split("=")[1]);document.title=`${e} 的搜索结果 | 宅日记`,document.getElementById("page-title").innerText=e+" 的搜索结果",fetch("/search.json").then((function(e){return e.json()})).then((function(n){let t=[];n.forEach((function(n){const o=new RegExp(e,"i");(o.test(n.title)||o.test(n.keywords))&&t.push(n)})),t.length>0?(document.getElementById("search-message").style.display="none",function(e){const n=document.getElementById("main"),t=document.createDocumentFragment();e.forEach((function(e){const n=document.createElement("article");n.classList.add("posts"),n.innerHTML=`\n      <header class="posts-header">\n          <h2 class="posts-title">\n            <a class="post-title-link" href="${e.path}">${e.title}</a>\n          </h2>\n      </header>\n      <div class="posts-content">\n        <p>${e.img?`<img src=${e.img}>`:""}</p>\n        <p>${e.excerpt?`${e.excerpt}<br>`:""}</p>\n        <a class="more-link" href="${e.path}#more">继续阅读→</a>\n      </div>\n      <footer id="posts-footer">\n        <span class="iconfont iconrili">\n          <a href="/" rel="bookmark">\n            <time>${e.date}</time>\n          </a>\n        </span>\n        <span class="iconfont iconwenjianjia">\n          <a href="/categories/${e.categories}/" rel="category">${e.categories}</a>\n        </span>\n        ${e.tag?`<span class="iconfont iconbiaoqian">\n          <a href="/tags/${e.tag}/" rel="category tag">${e.tag}</a>\n        </span>`:null}\n        <span class="iconfont iconeye" >\n        <span id="${e.path}" class="leancloud_visitors" data-flag-title="${e.title}"></span>\n        </span>\n      </footer>\n    `,t.appendChild(n)})),n.appendChild(t)}(t),r.refresh(document.getElementById("main"))):document.getElementById("search-message").innerText="未找到"}))},foo.menuToggle=E,foo.loadValine=y,n.onclick=E,w(),document.getElementById("search-form").onsubmit=function(e){const n=document.getElementById("search-input"),t=n.value.trim();null!==t&&""!==t||(e.preventDefault(),n.value="")},document.getElementById("search-input").onblur=function(){document.getElementById("search-input").value=""},document.getElementById("xm").onclick=function(){"dark"===document.documentElement.getAttribute("data-theme")?(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light")):(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark"))},window.addEventListener("load",(function(){p(e+"/npm/vanilla-lazyload@17.1.3/dist/lazyload.min.js",(function(){l=new LazyLoad({elements_selector:".lazyload"})})),p(e+"/npm/instant.page@5.1.0/instantpage.js"),p(e+"/npm/pjax/pjax.min.js",f),p(e+"/npm/aplayer/dist/APlayer.min.js",(function(){p(e+"/npm/meting/dist/Meting.min.js")})),p(e+"/gh/track23/blog-static/Valine.min.js",y),window.screen.width>955?(document.getElementById("landlord").style.display="block",p(e+"/gh/track23/blog-static/live2d/js/live2d.js",(function(){loadlive2d("live2d",e+"/gh/track23/blog-static/live2d/model/2/2.json")})),p(e+"/gh/track23/blog-static/live2d/js/message.js")):(document.getElementById("memu").onclick=E,document.getElementById("tagcloud").onclick=E,document.querySelector(".site-title>a").onclick=function(){t.classList.contains("toggle-on")&&E()}),p(e+"/gh/track23/blog-static/js/av-core-mini-0.6.4.js",v)})),document.addEventListener("pjax:send",(function(){var e=20;g.classList.add("loading"),u.style.width=e+"%",clearInterval(m),m=setInterval((function(){(e+=3)>95&&(e=95),u.style.width=e+"%"}),500)})),document.addEventListener("pjax:complete",(function(){clearInterval(m),u.style.width="100%",g.classList.remove("loading"),setTimeout((function(){u.style.width=0}),400),l.update(),("dark"===localStorage.getItem("theme")||(new Date).getHours()>=21||(new Date).getHours()<7||matchMedia("(prefers-color-scheme: dark)").matches)&&document.documentElement.setAttribute("data-theme","dark"),w(),v()}))})();